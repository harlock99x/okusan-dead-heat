<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥¥ã•ã‚“ã®éš£ã€æ­»å®ˆã›ã‚ˆï¼ - æ±ºå®šç‰ˆ</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: #fdf6e3; text-align: center; margin: 0; padding: 10px; color: #5d4037; }
        h1 { font-size: 24px; margin-bottom: 5px; }
        #board { display: flex; justify-content: center; gap: 5px; margin: 20px auto; max-width: 95%; overflow-x: auto; padding: 10px; }
        .cell { min-width: 80px; height: 100px; border: 2px solid #d3c6aa; background: #fff; border-radius: 8px; display: flex; align-items: flex-end; justify-content: center; font-size: 10px; position: relative; padding-bottom: 5px; }
        .cell.goal { background: #ffe3e3; border: 2px solid #ff6b6b; font-weight: bold; }
        
        .piece { 
            width: 45px; height: 45px; border-radius: 50%; position: absolute; 
            border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background-size: cover; background-position: center; z-index: 10;
            top: 10px; transition: all 0.3s ease;
            display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; text-shadow: 1px 1px 2px black;
        }
        /* ç”»åƒãŒãªã„æ™‚ã®äºˆå‚™è‰² */
        .reia { background-color: #5d4037; }
        .mitsune { background-color: #bcaaa4; }
        .pekko { background-color: #333; }

        .controls { background: white; padding: 15px; border-radius: 15px; display: inline-block; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 90%; max-width: 400px; }
        .log { margin-top: 15px; height: 150px; overflow-y: scroll; background: #f8f9fa; padding: 10px; font-size: 13px; text-align: left; border: 1px solid #eee; border-radius: 8px; }
        button { padding: 12px 24px; font-size: 18px; cursor: pointer; background: #859900; color: white; border: none; border-radius: 50px; width: 100%; transition: 0.2s; box-shadow: 0 4px #586e75; }
        button:active { transform: translateY(3px); box-shadow: 0 1px #586e75; }
        .status-bar { font-size: 14px; margin-bottom: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>å¥¥ã•ã‚“ã®éš£ã€æ­»å®ˆã›ã‚ˆï¼</h1>

    <div id="board">
        <div class="cell" id="cell0">ä¸»äººã®è…•</div>
        <div class="cell" id="cell1">å»Šä¸‹</div>
        <div class="cell" id="cell2">ãƒªãƒ“ãƒ³ã‚°</div>
        <div class="cell" id="cell3">ã‚½ãƒ•ã‚¡</div>
        <div class="cell" id="cell4">å¯å®¤</div>
        <div class="cell" id="cell5">ãƒ™ãƒƒãƒ‰ä¸‹</div>
        <div class="cell goal" id="cell6">å¥¥ã•ã‚“ã®éš£</div>
    </div>

    <div class="controls">
        <div class="status-bar">æ¬¡ï¼š<span id="current-cat-name">???</span></div>
        <button id="draw-btn" onclick="playTurn()">ã‚«ãƒ¼ãƒ‰ã‚’å¼•ããƒ‹ãƒ£ï¼</button>
        <div class="log" id="log">3åŒ¹ã¨ã‚‚æº–å‚™ä¸‡ç«¯ã ï¼</div>
    </div>

    <script>
        const cats = [
            { id: 'reia', name: 'ãƒ¬ã‚¤ã‚¢', pos: 0, class: 'reia', img: 'reia.jpg', type: 'wait', label: 'ãƒ¬' },
            { id: 'mitsune', name: 'ãƒŸãƒ„ãƒ', pos: 0, class: 'mitsune', img: 'mitsune.jpg', type: 'escape', label: 'ãƒŸ' },
            { id: 'pekko', name: 'ãƒšãƒƒã‚³', pos: 0, class: 'pekko', img: 'pekko.jpg', type: 'attack', label: 'ãƒš' }
        ];

        const deck = [
            { name: 'å…¨åŠ›ãƒ€ãƒƒã‚·ãƒ¥', move: 2, msg: 'ãŒçŒ›ãƒ€ãƒƒã‚·ãƒ¥ï¼' },
            { name: 'ã‚¹ãƒ«ã‚¹ãƒ«é€²ã‚€', move: 1, msg: 'ãŒå¿ã³å¯„ã‚‹ã€‚' },
            { name: 'ç§˜å¯†ã®æŠœã‘é“', move: 3, msg: 'ã‚’ç™ºè¦‹ï¼ä¸€æ°—ã«ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼' },
            { name: 'ä¸»äººã®æŠ±ã£ã“', move: -99, msg: 'ã«æ•ã¾ã£ãŸï¼' },
            { name: 'å¤§é‹å‹•ä¼š', move: 0, msg: 'ç™ºç”Ÿï¼å…¨å“¡ã®å ´æ‰€ãŒã‚ã¡ã‚ƒãã¡ã‚ƒã ï¼', event: 'shuffle' },
            { name: 'ãŠã‚„ã¤ã‚¿ã‚¤ãƒ ', move: 0, msg: 'ã«ä¸»äººãŒå¤¢ä¸­ï¼å…¨å“¡1é€²ã‚€ï¼', event: 'bonus' }
        ];

        let currentCatIndex = 0;

        function updateBoard() {
            document.querySelectorAll('.piece').forEach(p => p.remove());
            cats.forEach(cat => {
                const cell = document.getElementById('cell' + Math.min(cat.pos, 6));
                const piece = document.createElement('div');
                piece.className = `piece ${cat.class}`;
                // ç”»åƒè¨­å®šï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã¯èƒŒæ™¯è‰²ã®ã¿ï¼‰
                piece.style.backgroundImage = `url(${cat.img})`;
                piece.innerText = cat.label; // ç”»åƒãŒãªã„æ™‚ã®ãŸã‚ã®åå‰ä¸€æ–‡å­—

                // é‡ãªã‚Šä½ç½®èª¿æ•´
                if (cat.id === 'mitsune') piece.style.transform = 'translateX(-15px)';
                if (cat.id === 'pekko') piece.style.transform = 'translateX(15px)';
                
                cell.appendChild(piece);
            });
            document.getElementById('current-cat-name').innerText = cats[currentCatIndex].name;
        }

        function playTurn() {
            const cat = cats[currentCatIndex];
            const card = deck[Math.floor(Math.random() * deck.length)];
            const log = document.getElementById('log');
            let message = `<b>ã€${cat.name}ã€‘</b> ${card.name}`;

            if (card.event === 'shuffle') {
                cats.forEach(c => c.pos = Math.floor(Math.random() * 5));
                message = "ğŸ  <b>é‹å‹•ä¼šï¼</b> å…¨å“¡ãƒãƒ©ãƒãƒ©ã«ãªã£ãŸï¼";
            } else if (card.event === 'bonus') {
                cats.forEach(c => c.pos = Math.min(c.pos + 1, 6));
                message = "ğŸ— <b>ãŠã‚„ã¤ï¼</b> å…¨å“¡ã¤ã‚‰ã‚Œã¦1æ­©å‰é€²ï¼";
            } else if (card.move === -99) {
                // ç‰¹æ®Šèƒ½åŠ›ãƒã‚§ãƒƒã‚¯
                if (cat.type === 'escape' && Math.random() > 0.5) {
                    message += "â€¦ã ãŒæ¶²ä½“åŒ–ã—ã¦é€ƒã’åˆ‡ã£ãŸï¼";
                } else if (cat.type === 'attack' && Math.random() > 0.4) {
                    message += "â€¦ãŒã€çˆªã§æŠµæŠ—ã—ã¦å›é¿ï¼";
                } else {
                    cat.pos = 0;
                    message += "ã€‚ã‚¹ã‚¿ãƒ¼ãƒˆã¸é€£è¡Œã•ã‚ŒãŸâ€¦";
                }
            } else {
                cat.pos += card.move;
                message += card.msg;
            }

            // ãƒ¬ã‚¤ã‚¢ã®è¿½å¾“èƒ½åŠ›
            if (cat.id !== 'reia' && Math.random() > 0.7) {
                const reia = cats.find(c => c.id === 'reia');
                reia.pos = Math.min(reia.pos + 1, 6);
                message += " (ãƒ¬ã‚¤ã‚¢ã‚‚ä¾¿ä¹—ï¼)";
            }

            log.innerHTML = `<div>${message}</div>` + log.innerHTML;
            
            if (cat.pos >= 6) {
                cat.pos = 6;
                updateBoard();
                setTimeout(() => {
                    alert(`${cat.name}ã®å‹åˆ©ï¼å¥¥ã•ã‚“ã®éš£ã¯æ¸¡ã•ãªã„ãƒ‹ãƒ£ï¼`);
                    resetGame();
                }, 100);
            } else {
                currentCatIndex = (currentCatIndex + 1) % cats.length;
                updateBoard();
            }
        }

        function resetGame() {
            cats.forEach(c => c.pos = 0);
            currentCatIndex = 0;
            updateBoard();
            document.getElementById('log').innerText = "æ–°ã—ã„å¤œãŒå§‹ã¾ã£ãŸâ€¦";
        }

        window.onload = updateBoard;
    </script>
</body>
</html>
